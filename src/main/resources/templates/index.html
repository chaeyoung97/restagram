<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>Title</title>

    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/css/swiper.min.css">
</head>
<style>
    .swiper-container {
        width:90%;
        height:90%;
        border:5px solid silver;
        border-radius:7px;
        box-shadow:0 0 20px #ccc inset;
    }
    .swiper-slide {
        text-align:center;
        display:flex; /* 내용을 중앙정렬 하기위해 flex 사용 */
        align-items:center; /* 위아래 기준 중앙정렬 */
        justify-content:center; /* 좌우 기준 중앙정렬 */
    }
    .swiper-slide img {
        box-shadow:0 0 5px #555;
    }
</style>
<body>


<section id="container">

    {{>layout/navigator}}

    <div class="hidden_menu">
        <div class="scroll_inner">
            <div class="user">
                <div class="thumb_img"><img src="/imgs/thumb.jpeg" alt="프로필사진"></div>
                <div class="id">kindtigerrr</div>
            </div>

            <div class="user">
                <div class="thumb_img"><img src="/imgs/thumb.jpeg" alt="프로필사진"></div>
                <div class="id">kindtigerrr</div>
            </div>
            <div class="user">
                <div class="thumb_img"><img src="/imgs/thumb.jpeg" alt="프로필사진"></div>
                <div class="id">kindtigerrr</div>
            </div>
            <div class="user">
                <div class="thumb_img"><img src="/imgs/thumb.jpeg" alt="프로필사진"></div>
                <div class="id">kindtigerrr</div>
            </div>
            <div class="user">
                <div class="thumb_img"><img src="/imgs/thumb.jpeg" alt="프로필사진"></div>
                <div class="id">kindtigerrr</div>
            </div>
            <div class="user">
                <div class="thumb_img"><img src="/imgs/thumb.jpeg" alt="프로필사진"></div>
                <div class="id">kindtigerrr</div>
            </div>
            <div class="user">
                <div class="thumb_img"><img src="/imgs/thumb.jpeg" alt="프로필사진"></div>
                <div class="id">kindtigerrr</div>
            </div>
            <div class="user">
                <div class="thumb_img"><img src="/imgs/thumb.jpeg" alt="프로필사진"></div>
                <div class="id">kindtigerrr</div>
            </div>
            <div class="user">
                <div class="thumb_img"><img src="/imgs/thumb.jpeg" alt="프로필사진"></div>
                <div class="id">kindtigerrr</div>
            </div>
            <div class="user">
                <div class="thumb_img"><img src="/imgs/thumb.jpeg" alt="프로필사진"></div>
                <div class="id">kindtigerrr</div>
            </div>

        </div>
    </div>

    <section id="main_container">
        <div class="inner">
            {{#followPosts}}
            <div class="contents_box">
                <article class="contents">
                    <header class="top">
                        <div class="user_container">
                            <div class="profile_img">
                                <a href="/profile/{{user.username}}"><img src="{{user.profileImage}}" alt="프로필이미지"></a>
                            </div>
                            <div class="user_name">
                                <div class="nick_name m_text"> <a href="/profile/{{user.username}}" style="text-decoration: none">{{user.username}}</a></div>
                                <div class="country s_text">Seoul, South Korea</div>
                            </div>

                        </div>


                    </header>

                    <div class="img_section">
                        <div class="trans_inner">
                            <div class="swiper-container swiper1">
                                <div class="swiper-wrapper">
                                    {{#images}}
                                    <div class="swiper-slide"> <a href="/posts/detail/{{id}}"><img src="{{imageURL}}"></a></div>
                                    {{/images}}
                                </div>

                                <!-- 네비게이션 버튼 -->
                                <div class="swiper-button-next"></div><!-- 다음 버튼 (오른쪽에 있는 버튼) -->
                                <div class="swiper-button-prev"></div><!-- 이전 버튼 -->

                                <!-- 페이징 -->
                                <div class="swiper-pagination"></div>
                            </div>

                        </div>
                    </div>
                    <div>
                        <div>
                            <a href="/posts/detail/{{id}}" style="text-decoration: none"><textarea readonly style="resize: none;overflow-y:hidden;border: none;background-color: transparent">{{content}}</textarea></a>
                        </div>
                    </div>
                    <div class="bottom_icons">
                        <div class="left_icons">
                            <div class="heart_btn{{id}}" >
                                {{#liked}}
                                <div class="sprite_heart_icon" data-name="heartbeat" onclick = "event.preventDefault();like(this)" name = "{{id}}"></div>
                                {{/liked}}
                                {{^liked}}
                                <div class="sprite_heart_icon_outline" data-name="heartbeat" onclick = "event.preventDefault();like(this)" name = "{{id}}"></div>
                                {{/liked}}
                            </div>
                        <!--    <div class="sprite_bubble_icon"></div>
                          <div class="sprite_share_icon" data-name="share"></div> -->
                        </div>
                       <div class="right_icon">
                          <!--   <div class="sprite_bookmark_outline" data-name="bookmark"></div>-->
                        </div>

                    </div>

                    <div class="likes m_text">
                        좋아요
                        <span id="like-count-39" class = "{{id}}">{{likeCnt}}</span>
                        <span id="bookmark-count-39"></span>
                        개
                    </div>

                    <div class="comment_container">
                        <div class="comment" id="comment-list-ajax-post37">
                            <div class="comment-detail">
                                <div class="nick_name m_text">dongdong2</div>
                                <div> <a href="/posts/detail/{{id}}" style="text-decoration: none">강아지가 너무 귀여워요~!</a></div>
                            </div>
                        </div>
                        <div class="small_heart">
                            <div class="sprite_small_heart_icon_outline"></div>
                        </div>
                    </div>

                    <div class="timer">1시간 전</div>

                    <div class="comment_field" id="add-comment-post37">
                        <input type="text" placeholder="댓글달기...">
                        <div class="upload_btn m_text" data-name="comment">게시</div>
                    </div>
                </article>
            </div>
            {{/followPosts}}
            <input type="hidden" id="page" value="1">

            <div class="side_box">
                <div class="user_profile">
                    <div class="profile_thumb">
                        <img src="/imgs/thumb.jpeg" alt="프로필사진">
                    </div>
                    <div class="detail">
                        <div class="id m_text">KindTiger</div>
                        <div class="ko_name">심선범</div>
                    </div>
                </div>

                <article class="story">
                    <header class="story_header">
                        <div>스토리</div>
                        <div class="more">모두 보기</div>
                    </header>

                    <div class="scroll_inner">
                        <div class="thumb_user">
                            <div class="profile_thumb">
                                <img src="/imgs/thumb02.jpg" alt="프로필사진">
                            </div>
                            <div class="detail">
                                <div class="id">kind_tigerrrr</div>
                                <div class="time">1시간 전</div>
                            </div>
                        </div>
                        <div class="thumb_user">
                            <div class="profile_thumb">
                                <img src="/imgs/thumb02.jpg" alt="프로필사진">
                            </div>
                            <div class="detail">
                                <div class="id">kind_tigerrrr</div>
                                <div class="time">1시간 전</div>
                            </div>
                        </div>
                        <div class="thumb_user">
                            <div class="profile_thumb">
                                <img src="/imgs/thumb02.jpg" alt="프로필사진">
                            </div>
                            <div class="detail">
                                <div class="id">kind_tigerrrr</div>
                                <div class="time">1시간 전</div>
                            </div>
                        </div>
                        <div class="thumb_user">
                            <div class="profile_thumb">
                                <img src="/imgs/thumb02.jpg" alt="프로필사진">
                            </div>
                            <div class="detail">
                                <div class="id">kind_tigerrrr</div>
                                <div class="time">1시간 전</div>
                            </div>
                        </div>
                        <div class="thumb_user">
                            <div class="profile_thumb">
                                <img src="/imgs/thumb02.jpg" alt="프로필사진">
                            </div>
                            <div class="detail">
                                <div class="id">kind_tigerrrr</div>
                                <div class="time">1시간 전</div>
                            </div>
                        </div>
                    </div>
                </article>

                <article class="recommend">
                    <header class="reco_header">
                        <div>회원님을 위한 추천</div>
                        <div class="more">모두 보기</div>
                    </header>

                    <div class="thumb_user">
                        <div class="profile_thumb">
                            <img src="/imgs/thumb02.jpg" alt="프로필사진">
                        </div>
                        <div class="detail">
                            <div class="id">kind_tigerrrr</div>
                            <div class="time">1시간 전</div>
                        </div>
                    </div>
                    <div class="thumb_user">
                        <div class="profile_thumb">
                            <img src="/imgs/thumb02.jpg" alt="프로필사진">
                        </div>
                        <div class="detail">
                            <div class="id">kind_tigerrrr</div>
                            <div class="time">1시간 전</div>
                        </div>
                    </div>
                </article>
            </div>


        </div>
    </section>



</section>
{{>layout/footer}}

<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/js/swiper.min.js"></script>
<script>
    new Swiper('.swiper1', {
        pagination : { // 페이징 설정
            el : '.swiper-pagination',
            clickable : true, // 페이징을 클릭하면 해당 영역으로 이동, 필요시 지정해 줘야 기능 작동
        },
        navigation : { // 네비게이션 설정
            nextEl : '.swiper-button-next', // 다음 버튼 클래스명
            prevEl : '.swiper-button-prev', // 이번 버튼 클래스명
        },
    });

    function like(myVal){
        var my = $(myVal)
        id = $(myVal).attr("name");
        var like_cnt = $("."+id);
        console.log("좋아요 버튼 클릭");
        console.log("좋아요 url: "+'/api/likes/posts/'+id)
        $.ajax({
            type: 'get',
            url: '/api/likes/posts/'+id,
            async: false,
            error: onError,
            success: onSuccess= function (response){
            console.log(response);
                if(response == 0 ){
                    my.attr("class", 'sprite_heart_icon_outline');
                    like_cnt.text(eval(parseInt(like_cnt.text())-1));
                }else if(response > 0){
                    my.attr("class", 'sprite_heart_icon');
                    like_cnt.text(eval(parseInt(like_cnt.text())+1));

                }else{
                    alert("권한이 없는 접근입니다.");
                }
        }
        });
    }

    function onError(){}
</script>

</body>
</html>